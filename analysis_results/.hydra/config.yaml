debug_autograd_anomaly: false
use_mamba_nan_callback: true
mamba_nan_callback_freq: 500
data:
  data_dir: .
  sagemaker_channel_name: training
  use_regime_splicing: true
  regime_definitions:
    train_High_Vol_Crash:
    - - '2020-02-15'
      - '2020-04-30'
    train_Bull_Market:
    - - '2020-06-01'
      - '2020-09-30'
    train_Bear_Market:
    - - '2022-04-01'
      - '2022-07-31'
    train_Sideways_Chop:
    - - '2023-07-01'
      - '2023-10-31'
    train_Low_Vol_Grind:
    - - '2021-10-01'
      - '2021-12-31'
    validation_set:
    - - '2023-01-01'
      - '2023-06-30'
    test_set:
    - - '2024-01-01'
      - '2024-12-31'
  cleaning:
    min_allowable_price: 0.01
    outlier_rolling_window: 21
    outlier_median_dev_threshold: 0.2
  symbol: MNQ
  timeframe_tag: 5min
  data_filenames:
  - MNQ_ohlcv5m_2020Q1.csv
  - MNQ_ohlcv5m_2020Q2.csv
  - MNQ_ohlcv5m_2020Q3.csv
  - MNQ_ohlcv5m_2020Q4.csv
  - MNQ_ohlcv5m_2021Q1.csv
  - MNQ_ohlcv5m_2021Q2.csv
  - MNQ_ohlcv5m_2021Q3.csv
  - MNQ_ohlcv5m_2021Q4.csv
  - MNQ_ohlcv5m_2022Q1.csv
  - MNQ_ohlcv5m_2022Q2.csv
  - MNQ_ohlcv5m_2023Q1.csv
  - MNQ_ohlcv5m_2023Q2.csv
  - MNQ_ohlcv5m_2023Q3.csv
  - MNQ_ohlcv5m_2023Q4.csv
  - MNQ_ohlcv5m_2024Q1.csv
  - MNQ_ohlcv5m_2024Q2.csv
  - MNQ_ohlcv5m_2024Q3.csv
  - MNQ_ohlcv5m_2024Q4.csv
features:
  hurst_window: 100
  momentum_window: 21
  volatility_window: 21
  z_score_window: 60
  pct_change_cap: 0.05
  hl_pct_cap: 0.05
  hmm_n_components: 2
  hmm_min_samples: 500
environment:
  env_id: FuturesTradingEnv-v0
  max_episode_steps: 4096
  initial_balance: 50000.0
  add_bid_ask_spread: true
  spread_ticks_min: 1
  spread_ticks_max: 2
  max_slippage_points: 0.25
  reward_type: profit
  hold_penalty_scale: 0.0
  activity_reward_scale: 0.0
  max_consecutive_holds_limit: 900
  min_lookback_hpo: 200
  max_lookback_hpo: 400
  lookback_window: 250
  point_value: 0.2
  tick_size: 0.25
  commission_per_contract: 0.04
model:
  net_arch_pi_vf_options:
  - - 64
    - 64
  - - 128
    - 128
  mlp_activation_fn_name: relu
  mamba_activation_fn_name: silu
  mamba_extractor_validation:
    input_nan_inf_replacement: 0.0
    input_clipping_value: 10.0
  mamba_d_conv_default: 2
  mamba_expand_default: 2
optimization:
  n_trials: 30
  timeout_seconds: null
  metric: sharpe
  direction: maximize
  max_eval_steps: 2000
  pruning:
    enabled: true
    pruner_type: MedianPruner
    n_startup_trials: 5
    n_warmup_steps: 10
    interval_steps: 2
  n_jobs: 1
  trial_timesteps: 90000
  lr_min: 1.0e-06
  lr_max: 3.0e-06
  ppo_n_steps_choices_hpo:
  - 512
  batch_size_choices:
  - 32
  - 64
  - 128
  gamma_min: 0.98
  gamma_max: 0.999
  gae_lambda_min: 0.81
  gae_lambda_max: 0.98
  ent_coef_min: 0.005
  ent_coef_max: 0.01
  vf_coef_min: 0.26
  vf_coef_max: 0.56
  max_grad_norm_min: 2.1
  max_grad_norm_max: 4.9
  clip_range_min: 0.3
  clip_range_max: 0.38
  weight_decay_min: 0.0001
  weight_decay_max: 0.001
  activity_reward_scale_min: 0.03
  activity_reward_scale_max: 0.1
  num_mamba_layers_min: 2
  num_mamba_layers_max: 3
  mamba_d_model_choices:
  - 64
  - 128
  mamba_d_state_choices:
  - 8
  - 16
  - 32
  features_dim_choices:
  - 128
  dropout_min: 0.15
  dropout_max: 0.2
  hurst_window_choices:
  - 50
  momentum_window_choices:
  - 10
  - 21
  - 42
  volatility_window_choices:
  - 10
  - 21
  - 42
training:
  total_timesteps: 1000000
  use_vec_normalize: true
  ppo_n_epochs: 10
  n_envs_final_train: 1
  use_subproc_vec_env: false
evaluation:
  deterministic_actions: true
saving:
  output_dir: output_mamba_${instrument.symbol}_${experiment.name}
  scaler_filename: ${instrument.symbol}_scaler_${experiment.name}.joblib
  optuna_study_name: ${instrument.symbol}_Opt_${experiment.name}
  optuna_db_name: optuna_study_${instrument.symbol}_${experiment.name}.db
  best_params_filename: ${instrument.symbol}_best_params_${experiment.name}.joblib
  final_model_filename: ${instrument.symbol}_final_model_${experiment.name}.zip
  vec_normalize_filename: ${instrument.symbol}_vecnormalize_final_${experiment.name}.pkl
  trades_filename: test_trades_${experiment.name}.csv
  equity_filename: test_equity_${experiment.name}.csv
  report_filename: ${instrument.symbol}_report_${experiment.name}.html
  optuna_history_plot: optuna_history_${experiment.name}.png
  optuna_importance_plot: optuna_importance_${experiment.name}.png
  equity_curve_plot: equity_curve_${experiment.name}.png
  positions_plot: positions_plot_${experiment.name}.png
  log_filename: mamba_rl_trading_${experiment.name}.log
  checkpoint_dir_name: checkpoints_${experiment.name}
device: auto
instrument:
  symbol: mnq
experiment:
  name: Phase5b_Refine
